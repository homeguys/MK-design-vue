import{_ as a,D as s,c as n,I as r,k as t,a as o,R as c,o as i}from"./chunks/framework.840RyDbT.js";const S=JSON.parse('{"title":"16.关于setState、setData后数值不及时更新的问题","description":"","frontmatter":{"title":"16.关于setState、setData后数值不及时更新的问题","date":"2020-11-22T08:34:49.000Z","tags":["Vue","React"]},"headers":[],"relativePath":"zh-CN/tech/vue&react/关于setState、setData后数值不及时更新的问题.md","filePath":"zh-CN/tech/vue&react/关于setState、setData后数值不及时更新的问题.md","lastUpdated":1745984976000}'),l={name:"zh-CN/tech/vue&react/关于setState、setData后数值不及时更新的问题.md"},_=t("h1",{id:"关于setstate、setdata后数值不及时更新的问题",tabindex:"-1"},[o("关于setState、setData后数值不及时更新的问题 "),t("a",{class:"header-anchor vp-link",href:"#关于setstate、setdata后数值不及时更新的问题","aria-label":'Permalink to "关于setState、setData后数值不及时更新的问题"'},"​")],-1),h=c('<h2 id="背景" tabindex="-1">背景 <a class="header-anchor vp-link" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h2><p>在开始写 setState 的时候， 都会有这个疑问。 为什么我已经对 state 的数值赋值了， 可是我接下来去用这个值的时候，却不是刚刚赋值过的数据。 其实原因很简单。</p><blockquote><p>Because, setState is asynchronously.</p></blockquote><h2 id="为什么要异步赋值" tabindex="-1">为什么要异步赋值 <a class="header-anchor vp-link" href="#为什么要异步赋值" aria-label="Permalink to &quot;为什么要异步赋值&quot;">​</a></h2><p>那么为什么要把赋值功能设置成异步， 做成同步难道不香么？ 如果做成了同步的功能， 我们的每次 set 操作， 就去触发一次页面的渲染也是一件很可怕的事情。 更多时候我们只是要一个结果， 而不是把每次数据变化精准的展示给用户。 而异步赋值的好处就是可以整合我们的操作。 这样在主线程之内无论我们一个数组 push 多少次， 那么实际上只是会渲染一次。</p><h2 id="关于-nexttick" tabindex="-1">关于 nexttick <a class="header-anchor vp-link" href="#关于-nexttick" aria-label="Permalink to &quot;关于 nexttick&quot;">​</a></h2><p>所谓 nexttick 就是当 DOM 渲染结束之后的一个回调函数。 我们可以在 nexttick 的回调函数中获得最新的数值。</p><p>要知道我们所有同步任务都是在主线程上执行的。 所有异步任务有了运行结果就会在任务队列中放置一个事件。 直到主线程的任务结束完毕， 就会去查看任务队列，将已完成的异步事件处理完毕。</p><p>而 nexttick 就是一个这样的异步任务。 在主线程的任务完成后， 就会开始执行更新渲染 DOM。 直到 DOM 渲染完毕， 这样 nexttick 就获取到了改变后的 DOM。</p><h2 id="后记" tabindex="-1">后记 <a class="header-anchor vp-link" href="#后记" aria-label="Permalink to &quot;后记&quot;">​</a></h2><p>之所以异步赋值也是为了优化性能，尽量减少 DOM 操作而考虑的。</p>',11);function p(d,u,m,k,x,D){const e=s("VPAuthor");return i(),n("div",null,[_,r(e,{members:[{avatar:"https://img-nj.piesat.cn/static/Frontend/avatar/gj.png",name:"耿健"},{avatar:"https://img-nj.piesat.cn/static/Frontend/avatar/wl.png",name:"王磊"}]},null,8,["members"]),h])}const b=a(l,[["render",p]]);export{S as __pageData,b as default};
