import{_ as o,D as i,c,I as l,k as a,a as e,R as s,o as r}from"./chunks/framework.840RyDbT.js";const R=JSON.parse('{"title":"macOS搭建本地gitlab","description":"","frontmatter":{"editLink":true},"headers":[],"relativePath":"zh-CN/tech/git/macOS搭建本地gitlab/index.md","filePath":"zh-CN/tech/git/macOS搭建本地gitlab/index.md","lastUpdated":1745984976000}'),p={name:"zh-CN/tech/git/macOS搭建本地gitlab/index.md"},d=a("h1",{id:"macos搭建本地gitlab",tabindex:"-1"},[e("macOS搭建本地gitlab "),a("a",{class:"header-anchor vp-link",href:"#macos搭建本地gitlab","aria-label":'Permalink to "macOS搭建本地gitlab"'},"​")],-1),h=a("h2",{id:"背景",tabindex:"-1"},[e("背景 "),a("a",{class:"header-anchor vp-link",href:"#背景","aria-label":'Permalink to "背景"'},"​")],-1),_=a("p",null,"有时候想要调试一些公司的项目， 不过公司的项目是没有办法传到 github 上的。 以免有泄漏的风险。 可是还需要借助 git 来管理， 于是乎，就诞生了本地搭建 gitlab 的想法。",-1),g=a("p",null,"另外，gitlab 还是功能蛮强大的， 拥有完善的权限管理系统， 集成 wiki 等相关功能， 以及具备 CI 持续集成、CD 持续部署等功能。 正好也借此机会玩一玩 gitlab ，完善一下自身搭建团队的技能树。",-1),b=a("h2",{id:"配置步骤",tabindex:"-1"},[e("配置步骤 "),a("a",{class:"header-anchor vp-link",href:"#配置步骤","aria-label":'Permalink to "配置步骤"'},"​")],-1),u=a("p",null,"由于 gitlab 只能在 Linux 内核环境下部署。 手上有一台 MacBook， 只好在上面再按照一个沙盒（虚拟机）了。",-1),k=a("li",null,[a("p",null,[e("下载"),a("code",null,"Docker Desktop"),e("。 市面上大部分教程都是推荐使用"),a("code",null,"Docker Desktop"),e("。 页面集成化界面操作，已经相对之前部署容易了很多。 并且注册一个"),a("code",null,"Docker Hub"),e("账号。")])],-1),m=a("code",null,"gitlab-ce",-1),v={href:"https://hub.docker.com/r/gitlab/gitlab-ce",class:"vp-link",target:"_blank",rel:"noreferrer"},x=s('<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker pull gitlab/gitlab-ce</span></span></code></pre></div><p>大概 800MB 大小，干脆挂机一宿下载完的。</p>',2),f=s(`<li><p>配置<code>gitlab</code></p><p>一早起来，就看到<code>Docker Desktop</code>的<code>Containers</code>里面已经静静的躺着个<code>gitlab/gitlab-ce</code>。 接下来就是按照教程配置 gitlab。 自带的 UI 页面有配置，不过依旧没有搞懂。 还是用命令行配置最简单。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo docker run -d \\</span></span>
<span class="line"><span> --hostname xxx.gitlab.com \\</span></span>
<span class="line"><span> --name gitlab \\</span></span>
<span class="line"><span> --restart always \\</span></span>
<span class="line"><span> --publish 22:22 --publish 80:80 --publish 443:443 \\</span></span>
<span class="line"><span> --volume /Users/xxx/gitlab/config:/etc/gitlab \\</span></span>
<span class="line"><span> --volume /Users/xxx/gitlab/logs:/var/log/gitlab \\</span></span>
<span class="line"><span> --volume /Users/xxx/gitlab/data:/var/opt/gitlab \\</span></span>
<span class="line"><span> gitlab/gitlab-ce:latest</span></span></code></pre></div></li><li><p>登录 gitlab 此刻通过浏览器输入：<code>http://localhost:80/</code>，即可到登录页面。 第一次登录会让你输入超级管理员的密码。 账号：root。 这个账号是最高权限。可以通过这个账号对 gitlab 配置一切。</p></li><li><p>注册 gitlab 账号 不过我们也不能一直用着 root 就去开发。 那也未免太过霸气侧漏了。 我们还是需要注册一个自己开发用的账号。 让我们退出登录。 在刚刚登录页面重新注册一个属于自己的账号、密码、邮箱。 此时这个账号注册还不能被使用登录。 我们需要通过 root 账户，对刚刚注册的账号进行授权通过， 这样新注册的账号才能被使用。</p></li><li><p>配置 SSH-KEY 新账号在登录之后，需要配置 git 公钥。 通过命令行</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ssh-keygen -t rsa -C &quot;xxx@mail.com&quot;</span></span></code></pre></div><p>在<code>.ssh/</code>目录下会生成两个文件<code>id_rsa.pub</code>和<code>id_rsa</code>， 我们需要将<code>id_rsa.pub</code>文件内的内容复制到 gitlab 中 <code>SSH-KEY</code>输入框中即可。</p></li><li><p>搭建仓库 新建仓库，然后本地代码跟仓库相关联，跟 github 很相似了。在这里就不再赘述了。</p></li>`,5),S=s('<h2 id="踩坑相关" tabindex="-1">踩坑相关 <a class="header-anchor vp-link" href="#踩坑相关" aria-label="Permalink to &quot;踩坑相关&quot;">​</a></h2><ol><li><p>下载<code>gitlab-ce</code>真的是太慢了。 估计镜像资源也不怎么好。</p></li><li><p>登录 gitlab 的时候报错 502。 这个问题纠结了好久。 网上说的大部分情况都是端口冲突。 又是杀进程，又是改配置的，结果并没起作用。</p><p>最后想到，可能我是通过 docker 配置的 gitlab。 应该是给 docker 分配的资源太少，导致的报错。 解决方法是： 在 docker 的<code>设置(Preferences)</code>-&gt;<code>Resource</code>-&gt;<code>ADVANCED</code>。 将<code>Swap</code>调整到了 <code>3GB</code>。 不过为了保险起见，其他硬件参数也都调高一些。 将<code>Memory</code>调整到了 <code>3.00GB</code></p></li></ol><h2 id="后记" tabindex="-1">后记 <a class="header-anchor vp-link" href="#后记" aria-label="Permalink to &quot;后记&quot;">​</a></h2><p>本来以为是一个很简单的事情， 结果也折腾来折腾去的搞了大半天。 不过终于搭建好仓库的时候， 还是很嗨皮的。 接下来有时间的时候可以好好玩一玩 CI 了~</p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor vp-link" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2>',5),C={href:"http://billqiu.github.io/2016/07/08/%E5%9C%A8mac%E4%B8%8A%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2gitlab/",class:"vp-link",target:"_blank",rel:"noreferrer"},D={href:"http://comdyn.hy.tsinghua.edu.cn/from-web/mac-os/570-docker-gitlat",class:"vp-link",target:"_blank",rel:"noreferrer"},T={href:"https://blog.csdn.net/rex1129/article/details/110119830",class:"vp-link",target:"_blank",rel:"noreferrer"},A={href:"https://blog.csdn.net/ianly123/article/details/82984736",class:"vp-link",target:"_blank",rel:"noreferrer"},P={href:"https://blog.csdn.net/top_code/article/details/50381432",class:"vp-link",target:"_blank",rel:"noreferrer"},E={href:"https://www.cnblogs.com/micrari/p/5659036.html",class:"vp-link",target:"_blank",rel:"noreferrer"};function V(y,B,N,I,q,w){const n=i("VPAuthor"),t=i("i-ri-external-link-line");return r(),c("div",null,[d,l(n,{members:[{avatar:"https://img-nj.piesat.cn/static/Frontend/avatar/gj.png",name:"耿健"},{avatar:"https://img-nj.piesat.cn/static/Frontend/avatar/wl.png",name:"王磊"}]},null,8,["members"]),h,_,g,b,u,a("ol",null,[k,a("li",null,[a("p",null,[e("下载"),m,e("。 在仓库找到 gitlab-ce 并下载。 "),a("a",v,[e("https://hub.docker.com/r/gitlab/gitlab-ce"),l(t,{class:"link-icon"})]),e(" 不过网上教程有一键下载的方式，不过我没有找到，最后还是通过命令行给安装上了。")]),x]),f]),S,a("ul",null,[a("li",null,[a("a",C,[e("1. 在 mac 上使用 docker 部署 gitlab"),l(t,{class:"link-icon"})])]),a("li",null,[a("a",D,[e("2. 基于 Docker 在 Mac OS X 系统中的部署和设置 GitLab"),l(t,{class:"link-icon"})])]),a("li",null,[a("a",T,[e("3. Docker gitlab 502 解决办法"),l(t,{class:"link-icon"})])]),a("li",null,[a("a",A,[e("4. 自建 gitlab 服务器以及出现 502 错误解决方案"),l(t,{class:"link-icon"})])]),a("li",null,[a("a",P,[e("5. 调整 git 仓库的连接地址"),l(t,{class:"link-icon"})])]),a("li",null,[a("a",E,[e("6. 多个 git 账号的 SSH 配置"),l(t,{class:"link-icon"})])])])])}const U=o(p,[["render",V]]);export{R as __pageData,U as default};
